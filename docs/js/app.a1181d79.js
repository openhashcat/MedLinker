(function(t){function e(e){for(var r,o,i=e[0],u=e[1],l=e[2],p=0,d=[];p<i.length;p++)o=i[p],n[o]&&d.push(n[o][0]),n[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);c&&c(e);while(d.length)d.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],r=!0,i=1;i<a.length;i++){var u=a[i];0!==n[u]&&(r=!1)}r&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var r={},n={app:0},s=[];function o(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=r,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(a,r,function(e){return t[e]}.bind(null,r));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var c=u;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var r=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("router-view")},s=[],o={name:"app"},i=o,u=a("2877"),l=Object(u["a"])(i,n,s,!1,null,null,null),c=l.exports,p=a("5f5b"),d=a("8c4f"),b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-container",{attrs:{fluid:""}},[a("Header",{attrs:{name:"MedLinker",content:"Copyright preservation, article publishing, data management."}}),a("Main"),a("Footer",{attrs:{name:"Hashcat"}})],1)},f=[],h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-row",[a("b-col",[a("header",[a("div",[a("b-jumbotron",{attrs:{"bg-variant":"info","text-variant":"white"}},[a("template",{slot:"header"},[a("h2",[t._v("\n                            "+t._s(t.name)+"\n                        ")])]),a("template",{slot:"lead"},[t._v("\n                        "+t._s(t.content)+"\n                    ")])],2)],1)])])],1)},m=[],v={name:"Header",props:["name","content"]},y=v,_=Object(u["a"])(y,h,m,!1,null,null,null),g=_.exports,w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("footer",{staticClass:"pt-4 my-md-5 pt-md-5 border-top"},[a("b-row",[a("b-col",{attrs:{cols:"2"}}),a("b-col",[a("small",{staticClass:"d-block mb-3 text-muted"},[t._v("powered by "+t._s(t.name)+". ")])]),a("b-col",{attrs:{cols:"6"}}),a("b-col",{attrs:{cols:"2"}})],1)],1)},x=[],k={name:"Footer",props:["name"]},O=k,j=Object(u["a"])(O,w,x,!1,null,null,null),P=j.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-row",[a("b-col",{attrs:{cols:"12",offset:"0",md:"8","offset-md":"2"}},[a("Search",{ref:"search",attrs:{placeholder:"文章ID",searchlabel:"查找"},on:{search:function(e){return t.getData(e)},keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getData(e)}}})],1)],1),a("hr"),a("b-row",[a("b-col",{attrs:{cols:"12",offset:"0",md:"8","offset-md":"2"}},[a("Tablist",{attrs:{posts:t.data}})],1)],1)],1)},C=[],M=(a("386d"),a("6762"),a("2fdb"),a("96cf"),a("3b8d")),S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-input-group",{staticClass:"mt-3",attrs:{prepend:t.label}},[a("b-form-input",{attrs:{state:t.searchState,"invalid-feedback":"请输入文章ID",placeholder:"0XX...XX"},model:{value:t.searchstr,callback:function(e){t.searchstr=e},expression:"searchstr"}}),a("b-input-group-append",[a("b-button",{attrs:{variant:"info",disabled:t.searching},on:{click:t.searcher,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searcher(e)}}},[t.searching?a("span",[a("b-spinner",{attrs:{small:""}}),t._v("\n                    "+t._s(t.searchlabel)+"中 ...\n                ")],1):t._e(),t.searching?t._e():a("span",[t._v("\n                    "+t._s(t.searchlabel)+"\n                ")])])],1)],1)},E=[],R={name:"Search",props:["placeholder","searchlabel"],data:function(){return{searchstr:"",inputstate:null,searching:!1}},methods:{searcher:function(){var t=/^(0x|0X)[0-9a-fA-F]{64}$/g;this.searchstr=this.searchstr.trim(),t.test(this.searchstr)?(this.$emit("search",this.searchstr),this.inputstate=!0):(console.log("match error"),this.inputstate=!1)}},computed:{label:function(){return"请输入"+this.placeholder+"："},searchState:function(){var t=this.searchstr.trim(),e=/^(0x|0X)[0-9a-fA-F]{64}$/g;return!!e.test(t)}}},H=R,F=Object(u["a"])(H,S,E,!1,null,null,null),N=F.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{role:"tablist"}},t._l(t.posts,function(e){return a("Card",t._b({key:e.id},"Card",e,!1))}),1)},U=[],D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-card",{staticClass:"mb-1",attrs:{"no-body":""}},[a("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[a("h5",{staticClass:"mb-0"},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:t.id,expression:"id"}],attrs:{block:"",href:"#"}},[t._v(t._s(t.name))])],1)]),a("b-collapse",{attrs:{id:t.id,visible:t.visible,accordion:"my-accordion",role:"tabpanel"}},[a("b-card-body",[a("b-card-text",[a("b-alert",{attrs:{show:"",variant:"success"}},[a("p",[t._v("\n                    文章哈希："+t._s(t.id)+"\n                    ")]),a("hr"),a("p",{staticClass:"mb-0"},[t._v("\n                    文章记录区块高度："),a("a",{attrs:{href:"https://rinkeby.etherscan.io/block/"+t.block_number}},[t._v(t._s(t.block_number))])])]),a("p",[t._v("\n                作者： "+t._s(t.author)+"\n                ")]),a("p",[t._v("\n                可用链接：\n                ")]),a("b-list-group",t._l(t.urls,function(e){return a("b-list-group-item",{key:e},[a("a",{attrs:{href:e}},[t._v(t._s(t.display(e))+" ：《"+t._s(t.name)+"》")])])}),1)],1)],1)],1)],1)},X=[],I=a("1816"),J=a.n(I),B={"github.com":"Github"},L={props:["id","name","author","visible","block_number","urls"],methods:{display:function(t){var e=new J.a(t);return B[e.host]}}},A=L,G=Object(u["a"])(A,D,X,!1,null,null,null),q=G.exports,z={name:"Tablist",props:["posts"],components:{Card:q}},K=z,Q=Object(u["a"])(K,T,U,!1,null,null,null),V=Q.exports,W=a("d225"),Y=a("b0b4"),Z=a("e573"),tt=a.n(Z),et=function(){function t(e,a){var r;Object(W["a"])(this,t),"undefined"!==typeof window.ethereum||"undefined"!==typeof window.web3?(r=window["ethereum"]||window.web3.currentProvider,this.writeable=!0):(r=new tt.a.providers.HttpProvider("https://rinkeby.infura.io/v3/e98a8cf4294243dfa895c02bfe2671aa"),this.writeable=!1),this.web3=new tt.a(r),this.abi=new this.web3.eth.Contract(e,a)}return Object(Y["a"])(t,[{key:"upload",value:function(){var t=Object(M["a"])(regeneratorRuntime.mark(function t(e){var a,r,n,s,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=this.web3.utils.utf8ToHex(JSON.stringify(e)),r=this.web3.utils.soliditySha3(a),console.log(a),console.log(r),n=this.abi.methods.newPostProfile(r,a),t.next=7,ethereum.enable();case 7:return s=t.sent,t.prev=8,t.next=11,n.send({from:s[0]});case 11:return o=t.sent,console.log(o),console.log(r),t.abrupt("return",r);case 17:return t.prev=17,t.t0=t["catch"](8),t.abrupt("return",!1);case 20:case"end":return t.stop()}},t,this,[[8,17]])}));function e(e){return t.apply(this,arguments)}return e}()},{key:"get",value:function(){var t=Object(M["a"])(regeneratorRuntime.mark(function t(e){var a,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.abi.methods.getPostProfile(e).call();case 2:return a=t.sent,r=JSON.parse(this.web3.utils.toUtf8(a)),r.id=e,t.next=7,this.abi.methods.getBlockNumber(e).call();case 7:return r.block_number=t.sent,t.abrupt("return",r);case 9:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()},{key:"getList",value:function(){var t=Object(M["a"])(regeneratorRuntime.mark(function t(e,a){var r,n,s,o,i,u,l,c;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return r={},r.data=[],t.next=4,this.abi.methods.totalPost().call();case 4:if(r.total=t.sent,void 0!=r.total){t.next=9;break}return t.abrupt("return",!1);case 9:if(n=e*a,s=(e+1)*a,!(r.total-1<n)){t.next=15;break}return t.abrupt("return",r);case 15:r.total>n&&r.total<=s&&(s=r.total);case 16:o=n;case 17:if(o==s){t.next=39;break}return t.next=20,this.abi.methods.getIndex(o).call();case 20:if(i=t.sent,u=void 0,void 0!=i){t.next=26;break}return t.abrupt("return",!1);case 26:return t.next=28,this.abi.methods.getPostProfile(i).call();case 28:return l=t.sent,t.next=31,this.abi.methods.getBlockNumber(i).call();case 31:c=t.sent;try{u=JSON.parse(web3.toUtf8(l))}catch(p){u={}}u.id=i,u.block_number=c,r.data.push(u);case 36:o++,t.next=17;break;case 39:return t.abrupt("return",r);case 40:case"end":return t.stop()}},t,this)}));function e(e,a){return t.apply(this,arguments)}return e}()}]),t}(),at=et,rt=[{constant:!1,inputs:[{name:"_id",type:"bytes32"},{name:"_profile",type:"bytes"}],name:"newPostProfile",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_id",type:"bytes32"}],name:"getBlockNumber",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_pos",type:"uint256"}],name:"getIndex",outputs:[{name:"",type:"bytes32"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_id",type:"bytes32"}],name:"getPostProfile",outputs:[{name:"",type:"bytes"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"totalPost",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],nt=rt,st={name:"Main",components:{Search:N,Tablist:V},data:function(){return{data:[],ids:[]}},methods:{getData:function(){var t=Object(M["a"])(regeneratorRuntime.mark(function t(e){var a,r,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(console.log(e),!this.ids.includes(e)){t.next=3;break}return t.abrupt("return");case 3:return a=new at(nt,"0x5fc35f37ca8c57f71f720a01c67a63db63d1efb0"),this.$refs.search.searching=!0,t.next=7,a.get(e);case 7:for(r=t.sent,this.$refs.search.searching=!1,n=0;n!=this.data.length;n++)this.data[n].visible=!1;r.visible=!0,this.data.push(r),this.ids.push(e),console.log(this.data);case 14:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}},ot=st,it=Object(u["a"])(ot,$,C,!1,null,null,null),ut=it.exports,lt={name:"Show",components:{Header:g,Footer:P,Main:ut}},ct=lt,pt=Object(u["a"])(ct,b,f,!1,null,null,null),dt=pt.exports,bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("b-container",{attrs:{fluid:""}},[a("Header",{attrs:{name:"MedLinker",content:"Copyright preservation, article publishing, data management."}}),a("Main"),a("Footer",{attrs:{name:"Hashcat"}})],1)},ft=[],ht=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-row",[a("b-col",{attrs:{md:"8","offset-md":"2"}},[t.status.post.success?a("b-alert",{attrs:{variant:"success",show:""}},[t._v("上传成功。文章ID为："+t._s(t.status.post.id))]):t._e(),t.status.post.failed?a("b-alert",{attrs:{variant:"danger",show:""}},[t._v("上传失败，请重试。")]):t._e()],1)],1),a("b-row",[a("b-col",{attrs:{md:"2","offset-md":"2",cols:"3"}},[a("label",{attrs:{for:"post-name"}},[t._v("文章标题：")])]),a("b-col",{attrs:{md:"6",cols:"9"}},[a("b-form-input",{attrs:{id:"post-name",type:"text"},model:{value:t.data.name,callback:function(e){t.$set(t.data,"name",e)},expression:"data.name"}})],1)],1),a("br"),a("b-row",[a("b-col",{attrs:{md:"2","offset-md":"2",cols:"3"}},[a("label",{attrs:{for:"post-author"}},[t._v("文章作者：")])]),a("b-col",{attrs:{md:"6",cols:"9"}},[a("b-form-input",{attrs:{id:"post-author",type:"text"},model:{value:t.data.author,callback:function(e){t.$set(t.data,"author",e)},expression:"data.author"}})],1)],1),a("br"),a("b-row",[a("b-col",{attrs:{md:"2","offset-md":"2",cols:"3"}},[a("label",{attrs:{for:"post-author"}},[t._v("文章链接：")])]),a("b-col",{attrs:{md:"6",cols:"9"}},[a("b-button",{attrs:{type:"submit",variant:"primary"},on:{click:t.addUrl}},[t._v("添加链接")])],1)],1),a("br"),t._l(t.data.urls.length,function(e){return a("div",{key:e},[a("b-row",[a("b-col",{attrs:{md:"2","offset-md":"2",cols:"3"}}),a("b-col",{attrs:{md:"6",cols:"9"}},[a("b-input-group",{staticClass:"mt-3"},[a("b-form-input",{attrs:{id:"post-"+(e-1),type:"text"},model:{value:t.data.urls[e-1],callback:function(a){t.$set(t.data.urls,e-1,a)},expression:"data.urls[i-1]"}}),a("b-input-group-append",[a("b-button",{attrs:{variant:"primary"},on:{click:function(a){return t.deleteUrl(e-1)}}},[t._v("删除")])],1)],1)],1)],1),a("br")],1)}),a("hr"),a("b-row",[a("b-col",{attrs:{md:"2","offset-md":"2",cols:"3"}}),a("b-col",{attrs:{md:"6",cols:"9"}},[a("b-button",{attrs:{variant:"primary",disabled:t.status.uploader.upload},on:{click:function(e){return t.uploadProfile()}}},[t.status.uploader.upload?a("span",[a("b-spinner",{attrs:{small:""}}),t._v("\n                    上传中 ...\n                ")],1):t._e(),t.status.uploader.upload?t._e():a("span",[t._v("\n                    上传\n                ")])])],1)],1)],2)},mt=[],vt={data:function(){return{data:{name:"",author:"",urls:[]},status:{uploader:{upload:!1},post:{id:"",success:!1,failed:!1}}}},methods:{addUrl:function(){this.data.urls.push("")},deleteUrl:function(t){this.data.urls.length>=0&&this.data.urls.splice(t,1)},uploadProfile:function(){var t=Object(M["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=new at(nt,"0x5fc35f37ca8c57f71f720a01c67a63db63d1efb0"),this.status.uploader.upload=!0,t.next=4,e.upload(this.data);case 4:a=t.sent,this.status.uploader.upload=!1,0==a?(this.status.post.failed=!0,this.status.post.success=!1):(this.status.post.id=a,this.status.post.success=!0,this.status.post.failed=!1);case 7:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},yt=vt,_t=Object(u["a"])(yt,ht,mt,!1,null,null,null),gt=_t.exports,wt={name:"Upload",components:{Header:g,Footer:P,Main:gt}},xt=wt,kt=Object(u["a"])(xt,bt,ft,!1,null,null,null),Ot=kt.exports;a("f9e3"),a("2dd8");r["default"].config.productionTip=!1,r["default"].use(p["a"]),r["default"].use(d["a"]);var jt=new d["a"]({routes:[{path:"/",component:dt},{path:"/upload",component:Ot}]});new r["default"]({render:function(t){return t(c)},router:jt}).$mount("#app")}});
//# sourceMappingURL=app.a1181d79.js.map